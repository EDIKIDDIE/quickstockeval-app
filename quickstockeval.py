<same as before, shortened here for clarity>